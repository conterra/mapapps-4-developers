name: Send PR events to MS Power Automate

on:
  pull_request_target:
    types: [opened]

jobs:
  notify-power-automate:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: POST raw PR event to Power Automate
        env:
          FLOW_URL: ${{ secrets.FLOW_WEBHOOK_URL }}
        run: |
          set -euo pipefail
          curl -sS -X POST \
            -H "Content-Type: application/json" \
            -H "X-GitHub-Event: pull_request" \
            -H "X-Repository: $GITHUB_REPOSITORY" \
            --data-binary "@$GITHUB_EVENT_PATH" \
            "$FLOW_URL"
